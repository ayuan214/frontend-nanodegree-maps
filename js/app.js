function Places(a){this.title=a.title,this.LatLng=a.gLatLng,this.bizID=a.bizID,this.marker=a.marker}function initializeMap(){var a={zoom:12,center:new google.maps.LatLng(37.77879,-122.389259)};return new google.maps.Map(document.getElementById("map_container"),a)}function initializeMarkers(a,b,c){for(var d=[],e=new google.maps.LatLngBounds,f=0;f<a.length;f++){var g=a[f].title,h=a[f].gLatLng[0],i=a[f].gLatLng[1],j=new google.maps.LatLng(h,i);d[f]=new google.maps.Marker({position:j,title:g}),a[f].marker=d[f],e.extend(j),google.maps.event.addListener(a[f].marker,"click",function(d){return function(){yelpAPI(b,a[d].marker,a[d].title,Model[d].bizID,c)}}(f))}return b.fitBounds(e),c}function yelpAPI(a,b,c,d,e){var f={consumerKey:"gRRJAGvD01BXyeZkXt9kUw",consumerSecret:"RqcoTBNLQaRAbV1bPtFqS_vdWA8",accessToken:"JbLZZ9MPRsM7tlv6WXwVex6KfU1t9p8z",accessTokenSecret:"8fasPNOG1EXM8dNQQx5n96VHVqk",serviceProvider:{signatureMethod:"HMAC-SHA1"}},g=d,h={consumerSecret:f.consumerSecret,tokenSecret:f.accessTokenSecret};parameters=[],parameters.push(["callback","cb"]),parameters.push(["oauth_consumer_key",f.consumerKey]),parameters.push(["oauth_consumer_secret",f.consumerSecret]),parameters.push(["oauth_token",f.accessToken]),parameters.push(["oauth_signature_method","HMAC-SHA1"]);var i={action:"http://api.yelp.com/v2/business/"+g,method:"GET",parameters:parameters};OAuth.setTimestampAndNonce(i),OAuth.SignatureMethod.sign(i,h);var j=OAuth.getParameterMap(i.parameters);console.log(j),$.ajax({url:i.action,data:j,cache:!0,dataType:"jsonp",jsonpCallback:"cb",success:function(d){console.log(d),console.log(d.rating_img_url);var h;h="<div id = 'content'><h3>"+c+"</h3>"+"<img class = 'yelp_image' src ="+d.rating_img_url+" alt = 'Yelp Review'></div>",e.setContent(h),e.open(a,b)},error:function(){var d;d="<div id = 'content'><h3>"+c+"</h3>"+"<p>Yelp Review unavailable</p></div>",e.setContent(d),e.open(a,b)}})}var Model=[{title:"AT&T Park",gLatLng:[37.778582,-122.38927],bizID:"at-and-t-park-san-francisco"},{title:"Ghirardelli Square",gLatLng:[37.805832,-122.423011],bizID:"ghirardelli-square-san-francisco?osq=Ghirdelli"},{title:"Oracle Arena",gLatLng:[37.75035,-122.203031],bizID:"oracle-arena-oakland"},{title:"Cliff House",gLatLng:[37.778472,-122.513952],bizID:"the-cliff-house-bistro-san-francisco"},{title:"Coit Tower",gLatLng:[37.802392,-122.405821],bizID:"coit-tower-san-francisco"},{title:"Orpheum Theatre",gLatLng:[37.779383,-122.414713],bizID:"orpheum-theatre-san-francisco"},{title:"Ike's Place",gLatLng:[37.764202,-122.430606],bizID:"ikes-place-san-francisco"}],ViewModel=function(){var a=this;a.filter=ko.observable(""),a.placesList=ko.observableArray([]);var b=initializeMap();infowindows=new google.maps.InfoWindow,a.map=ko.observable(b),a.infowindows=ko.observable(infowindows),initializeMarkers(Model,b,infowindows),Model.forEach(function(b){a.placesList.push(new Places(b))}),a.filteredItems=ko.computed(function(){return ko.utils.arrayFilter(a.placesList(),function(c){return-1!==c.title.toLowerCase().indexOf(a.filter().toLowerCase())?c.marker.setMap(b):c.marker.setMap(null),-1!==c.title.toLowerCase().indexOf(a.filter().toLowerCase())})},a),a.clickList=function(b){yelpAPI(a.map(),b.marker,b.title,b.bizID,a.infowindows())}};ko.applyBindings(new ViewModel);